<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PostBus Connect ‚Äì Navettes ski (B√äTA MobilityLab)</title>

<!-- Police propre et lisible -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
/* ====== Design system (simple & coh√©rent) ====== */
:root{
  --brand:#FFD300;           /* Jaune CarPostal */
  --brand-dark:#E5BE00;
  --ink:#0E0E0E;
  --ink-2:#3A3A3A;
  --bg:#FFFFFF;
  --bg-alt:#F6F7F9;
  --ok:#2E7D32;
  --danger:#C62828;
  --blue:#1F7AE0;
}
*{box-sizing:border-box} html,body{margin:0}
body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:#fff;line-height:1.5}
.container{width:min(1100px,92%);margin:auto}

/* ====== Top beta ribbon ====== */
.beta{
  position:sticky;top:0;z-index:9999;background:var(--ink);color:#fff;
  padding:8px 0;border-bottom:3px solid var(--brand);
  font-weight:600;font-size:.9rem;text-align:center
}
.beta small{opacity:.8;font-weight:400}

/* ====== Nav ====== */
nav{position:sticky;top:40px;z-index:999;background:rgba(255,255,255,.85);backdrop-filter:saturate(1.2) blur(6px);
  border-bottom:1px solid #EAEAEA}
nav .wrap{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
nav .logo{font-weight:800;letter-spacing:.2px}
nav ul{display:flex;gap:18px;list-style:none;margin:0;padding:0}
nav a{color:var(--ink-2);text-decoration:none;font-weight:600}
nav .cta{background:var(--brand);color:#000;padding:10px 14px;border-radius:8px;font-weight:800}
@media (max-width:860px){nav ul{display:none}}

/* ====== Hero ====== */
#hero{
  position:relative;color:#fff;text-align:center;display:grid;place-items:center;
  min-height:68vh;background:url('https://images.unsplash.com/photo-1516466723877-e4ec1d736c8a?q=80&w=1400&auto=format&fit=crop') center/cover no-repeat
}
#hero::after{content:"";position:absolute;inset:0;background:linear-gradient(0deg,rgba(0,0,0,.55),rgba(0,0,0,.35))}
#hero .inner{position:relative;padding:90px 0 70px}
h1{font-size:clamp(28px,4vw,44px);margin:0 0 10px;font-weight:800}
.tag{font-size:clamp(15px,2.2vw,20px);opacity:.95;max-width:780px;margin:0 auto 24px}
.ctas{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
.btn{display:inline-block;padding:14px 18px;border-radius:10px;font-weight:800;text-decoration:none}
.btn-primary{background:var(--brand);color:#000}
.btn-primary:hover{background:var(--brand-dark)}
.btn-ghost{border:2px solid #fff;color:#fff}

/* ====== Sections ====== */
section{padding:56px 0}
h2{font-size:clamp(22px,3.2vw,30px);margin:0 0 14px;font-weight:800;text-align:center}
.sub{color:var(--ink-2);text-align:center;margin-bottom:28px}

/* Steps */
.steps{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
.step{background:#fff;border:1px solid #EEE;border-radius:12px;padding:18px;text-align:center}
.step b{display:block;margin:6px 0 4px}
@media (max-width:860px){.steps{grid-template-columns:1fr}}

/* Avantages */
.grid-adv{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.adv{background:#fff;border-radius:12px;padding:18px;border:1px solid #EEE;text-align:center}
.adv .em{font-size:26px}
@media (max-width:1024px){.grid-adv{grid-template-columns:repeat(2,1fr)}}
@media (max-width:560px){.grid-adv{grid-template-columns:1fr}}

/* R√©servation */
.card{background:#fff;border:1px solid #E9E9E9;border-radius:14px;padding:18px}
.form{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.form label{font-weight:700;font-size:.92rem}
.form input,.form select{width:100%;padding:12px;border:1px solid #D9D9D9;border-radius:10px}
.form .full{grid-column:1/-1}
.form .submit{grid-column:1/-1}
.note{font-size:.9rem;color:#555}
.badge{display:inline-block;background:#111;color:#fff;padding:6px 8px;border-radius:999px;font-size:.78rem;font-weight:800}
.badge.green{background:var(--ok)} .badge.red{background:var(--danger)}
.badge.blue{background:var(--blue)} .badge.gold{background:var(--brand);color:#000}

/* R√©sultat r√©servation */
.result{margin-top:16px;display:none}
.result.show{display:block}
.result .row{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between}
.price{font-weight:800;font-size:1.6rem}

/* Seat map */
.seatmap{margin-top:14px;display:grid;grid-template-columns:repeat(5,44px);gap:8px;justify-content:center}
.seat{width:44px;height:44px;border-radius:8px;border:2px solid #C9C9C9;display:grid;place-items:center;cursor:pointer;background:#F9FAFB;font-weight:700}
.seat.premium{border-color:#B58900;background:#FFF7D1}
.seat.busy{opacity:.35;pointer-events:none}
.seat.sel{outline:3px solid var(--blue);border-color:var(--blue)}

/* Tarifs */
.prices{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
.card.hl{background:#FFF8D6;border-color:#E6C100}
.prbig{font-size:2rem;font-weight:800}
@media (max-width:860px){.prices{grid-template-columns:1fr}}

/* Carte + M√©t√©o */
#map{height:380px;background:#EAEAEA;border:1px dashed #CFCFCF;border-radius:12px}

/* Impact */
.impact{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.kpi{background:#fff;border:1px solid #EEE;border-radius:12px;padding:16px;text-align:center}
.kpi .v{font-size:1.6rem;font-weight:800}
@media (max-width:860px){.impact{grid-template-columns:1fr}}

footer{padding:32px 0;background:#111;color:#ddd;text-align:center;font-size:.9rem}
footer a{color:#fff;text-decoration:underline}

/* Helpers */
.mt8{margin-top:8px} .mt16{margin-top:16px} .mt24{margin-top:24px}
.center{text-align:center}
</style>
</head>
<body>

<!-- OBJECTIF 4 : Transparence prototype -->
<div class="beta">
  <span class="badge gold">B√äTA</span> &nbsp;Prototype test√© dans le cadre du <b>MobilityLab</b>.
  <small>Fonctionnalit√©s sujettes √† √©volution.</small>
</div>

<nav>
  <div class="container wrap">
    <div class="logo">PostBus Connect</div>
    <ul>
      <li><a href="#fonctionnement">Fonctionnement</a></li>
      <li><a href="#reservation">R√©server</a></li>
      <li><a href="#tarifs">Tarifs</a></li>
      <li><a href="#impact">Impact</a></li>
      <li><a href="#faq">FAQ</a></li>
    </ul>
    <a class="cta" href="#reservation">Planifier un trajet</a>
  </div>
</nav>

<header id="hero">
  <div class="inner container">
    <h1>Navettes directes vers les pistes, le week-end</h1>
    <p class="tag">Produit innovant by CarPostal pour <b>aller skier sans voiture</b> : d√©part √† l‚Äôouverture, retour en fin de journ√©e, confort + options premium. R√©servation & paiement instantan√©s.</p>
    <div class="ctas">
      <a class="btn btn-primary" href="#reservation">Planifier un trajet</a>
      <a class="btn btn-ghost" href="#avantages">Pourquoi c‚Äôest mieux ?</a>
    </div>
  </div>
</header>

<!-- OBJECTIF 2 : Exp√©rience simple et claire -->
<section id="fonctionnement">
  <div class="container">
    <h2>Comment √ßa marche</h2>
    <p class="sub">Saison de ski ¬∑ <b>vendredi, samedi, dimanche</b> ¬∑ 3 bus √ó 50 places</p>
    <div class="steps">
      <div class="step"><div>1Ô∏è‚É£</div><b>Choisissez</b> ville & station (week-end de la saison).</div>
      <div class="step"><div>2Ô∏è‚É£</div><b>Navette directe</b> align√©e sur l‚Äôouverture des installations.</div>
      <div class="step"><div>3Ô∏è‚É£</div><b>R√©servez & payez</b> en 2-3 √©tapes. <u>Option si√®ge premium</u>.</div>
    </div>
  </div>
</section>

<section id="avantages" style="background:var(--bg-alt)">
  <div class="container">
    <h2>Pourquoi c‚Äôest mieux ?</h2>
    <div class="grid-adv">
      <div class="adv"><div class="em">‚è±Ô∏è</div><b>+40‚Äì80 min</b><br>plus rapide que TP, selon l‚Äôaxe</div>
      <div class="adv"><div class="em">üß©</div><b>0 correspondance</b><br>monte & d√©tends-toi</div>
      <div class="adv"><div class="em">ü™ë</div><b>Si√®ge premium</b><br>r√©servation d‚Äôune place pr√©cise</div>
      <div class="adv"><div class="em">üå±</div><b>-75% CO‚ÇÇ</b><br>vs voiture (navette remplie)</div>
    </div>
  </div>
</section>

<!-- OBJECTIF 1 : mon√©tisation (pricing dynamique + premium) -->
<section id="reservation">
  <div class="container">
    <h2>Planifier & r√©server</h2>
    <p class="sub">Demi-tarif non valable. Forfait 5 A/R √† CHF 100 ci-dessous.</p>

    <div class="card">
      <form class="form" onsubmit="event.preventDefault(); simulateSearch();">
        <div>
          <label>Ville de d√©part</label>
          <select id="from" required>
            <option value="">S√©lectionnez‚Ä¶</option>
            <option>Gen√®ve</option><option>Lausanne</option><option>Fribourg</option>
            <option>Berne</option><option>Neuch√¢tel</option>
          </select>
        </div>

        <div>
          <label>Station</label>
          <select id="to" required>
            <option value="">S√©lectionnez‚Ä¶</option>
            <option data-lat="46.096" data-lon="7.228">Verbier</option>
            <option data-lat="46.020" data-lon="7.749">Zermatt</option>
            <option data-lat="46.311" data-lon="7.480">Crans-Montana</option>
            <option data-lat="46.296" data-lon="7.053">Villars</option>
          </select>
        </div>

        <div class="full">
          <label>Date (vendredi/samedi/dimanche)</label>
          <input id="date" type="date" required>
          <div class="note mt8">Saison param√©trable ‚Äì par d√©faut 1 d√©c ‚Üí 15 avr.</div>
        </div>

        <div class="full">
          <label><input type="checkbox" id="usePass"> J‚Äôutilise 1 trajet de mon forfait 5 A/R (reste g√©r√© c√¥t√© client)</label>
        </div>

        <div class="submit">
          <button class="btn btn-primary" style="width:100%">Voir les navettes</button>
        </div>
      </form>

      <!-- R√©sultat + step si√®ges -->
      <div id="result" class="result">
        <div class="row">
          <div>
            <b id="r-route">‚Äî</b><br>
            <span id="r-times">D√©part 07:00 ‚Äî Retour 16:45</span>
          </div>
          <div>
            <span class="badge blue">Tarif dynamique</span>
            <div class="price"><span id="r-price">CHF ‚Äî</span></div>
          </div>
        </div>

        <div class="mt16 note">S√©lectionnez votre si√®ge (rang 1‚Äì2 = <b>Premium +CHF <span id="premiumFeeLabel"></span></b>).</div>
        <div id="seatmap" class="seatmap" aria-label="Plan du bus (10 rang√©es √ó 5)"></div>

        <div class="row mt16">
          <div class="note">Si√®ge choisi : <b id="seatChosen">‚Äî</b></div>
          <div>
            <a class="btn btn-primary" href="#" onclick="checkout()">Payer maintenant</a>
          </div>
        </div>
        <div class="mt8 note">En validant vous acceptez les CG. Prototype B√äTA ‚Äì donn√©es fictives de paiement.</div>
      </div>
    </div>

    <p class="note mt16">‚è∞ D√©parts typiques : 06:30‚Äì07:30 (ville ‚Üí station). Retours 16:00‚Äì17:30 (station ‚Üí ville).  
    üöå Flotte pilote : 3 bus √ó 50 places.</p>
  </div>
</section>

<section id="tarifs" style="background:var(--bg-alt)">
  <div class="container">
    <h2>Tarifs</h2>
    <div class="prices">
      <div class="card hl">
        <div class="badge gold">Best value</div>
        <h3>Forfait 5 allers-retours</h3>
        <div class="prbig">CHF 100.‚Äì</div>
        <p>Soit 20.‚Äì par A/R. Id√©al pour la saison.</p>
        <p class="note">Non cumulable avec demi-tarif (non valable).</p>
      </div>
      <div class="card">
        <h3>Trajet √† l‚Äôunit√©</h3>
        <div class="prbig">D√®s CHF 25.‚Äì</div>
        <p>Prix <b>dynamique</b> selon remplissage (load factor) & anticipation.  
        + Option si√®ge premium.</p>
        <p class="note">R√©servez t√¥t pour les meilleurs prix.</p>
      </div>
    </div>
  </div>
</section>

<section id="impact">
  <div class="container">
    <h2>Impact (objectif 3)</h2>
    <p class="sub">R√©duction de la voiture individuelle gr√¢ce aux navettes directes.</p>
    <div class="impact">
      <div class="kpi"><div class="v" id="kpiTrips">0</div>trajets r√©serv√©s aujourd‚Äôhui</div>
      <div class="kpi"><div class="v" id="kpiCars">0</div>voitures √©vit√©es (est.)</div>
      <div class="kpi"><div class="v" id="kpiCO2">0 kg</div>CO‚ÇÇ √©vit√©s (est.)</div>
    </div>
    <p class="note mt8">Hypoth√®ses configurables : km A/R moyen, facteur CO‚ÇÇ voiture & bus, taux d‚Äôoccupation.</p>
  </div>
</section>

<section id="carte" style="background:var(--bg-alt)">
  <div class="container">
    <h2>Carte des itin√©raires (prototype)</h2>
    <p class="sub">Filtre par station & jour. (Ici une zone d‚Äôaccueil pour Leaflet/Google Maps.)</p>
    <div id="map" role="img" aria-label="Carte interactive √† int√©grer (Leaflet)"></div>
  </div>
</section>

<section id="meteo">
  <div class="container">
    <h2>M√©t√©o & neige</h2>
    <p class="sub">Aper√ßu automatis√© par station (exemple ‚Äì Open-Meteo).</p>
    <div id="weatherRow" class="steps"></div>
    <p class="note mt8">Sources : API m√©t√©o publiques. Les stations et coordonn√©es sont configurables.</p>
  </div>
</section>

<section id="faq" style="background:var(--bg-alt)">
  <div class="container">
    <h2>FAQ</h2>
    <details class="card"><summary><b>Quels jours roulent les navettes ?</b></summary>
      <div class="mt8">Vendredi, samedi, dimanche pendant la saison de ski (configurable).</div></details>
    <details class="card"><summary><b>Le demi-tarif fonctionne-t-il ?</b></summary>
      <div class="mt8">Non, le demi-tarif n‚Äôest pas valable sur cette offre.</div></details>
    <details class="card"><summary><b>Puis-je choisir un si√®ge pr√©cis ?</b></summary>
      <div class="mt8">Oui, certains si√®ges sont premium (+CHF) et r√©servable au plan.</div></details>
    <details class="card"><summary><b>Quid si la m√©t√©o est mauvaise ?</b></summary>
      <div class="mt8">Si la station ferme, modification ou remboursement sans frais.</div></details>
    <details class="card"><summary><b>Est-ce un produit officiel CarPostal ?</b></summary>
      <div class="mt8">C‚Äôest un <b>prototype B√äTA MobilityLab</b> pour valider march√© & impact.</div></details>
  </div>
</section>

<footer>
  ¬© 2025 MobilityLab & CarPostal ‚Äî <a href="#">Mentions l√©gales</a> ‚Äî <a href="#reservation">R√©server</a>
</footer>

<script>
/* ================== CONFIG PRODUIT ================== */
/* Objectifs 1/2/3 implant√©s via pricing, UX, impact. Objectif 4 via banni√®re. */
const CONFIG = {
  SEASON_START: new Date(new Date().getFullYear(), 11, 1), // 1 d√©c
  SEASON_END:   new Date(new Date().getFullYear()+1, 3, 15), // 15 avr (ann√©e suivante)
  WEEKEND_ONLY: true,
  BUSES: 3,
  SEATS_PER_BUS: 50,
  PREMIUM_ROWS: 2,       // rang√©es 1-2
  PREMIUM_FEE: 5,        // CHF
  BASE_MIN: 25,          // CHF (A/R)
  BASE_MAX: 45,          // CHF
  MAX_LEAD_DAYS: 35,     // anticipation max prise en compte
  AVG_ROUNDTRIP_KM: 180, // pour CO2 (personnalisable)
  CO2_CAR_KG_PER_KM: 0.18,
  CO2_BUS_KG_PER_KM_PER_PAX: 0.04
};
document.getElementById('premiumFeeLabel').textContent = CONFIG.PREMIUM_FEE.toFixed(0);

/* ================== OUTILS ================== */
function isWeekend(d){
  const wd = d.getDay(); // 0 dim .. 6 sam
  return wd===5 || wd===6 || wd===0;
}
function inSeason(d){
  return d>=CONFIG.SEASON_START && d<=CONFIG.SEASON_END;
}
function clamp(v,min,max){return Math.max(min,Math.min(max,v));}

/* Pricing dynamique fa√ßon EasyJet : d√©pend remplissage attendu + anticipation */
function dynamicPrice(leadDays, expectedLoad){
  const leadFactor = 1 - clamp(leadDays / CONFIG.MAX_LEAD_DAYS, 0, 1); // + cher quand proche
  const loadFactor = clamp(expectedLoad, 0, 1);                         // + cher quand plein
  const mix = 0.45*leadFactor + 0.55*loadFactor;
  return Math.round(CONFIG.BASE_MIN + (CONFIG.BASE_MAX - CONFIG.BASE_MIN) * mix);
}

/* Seat map (10 x 5) + premium premi√®res rang√©es */
function buildSeatmap(container){
  container.innerHTML = "";
  const rows = 10, cols = 5;
  for(let r=1;r<=rows;r++){
    for(let c=1;c<=cols;c++){
      const id = `${r}${String.fromCharCode(64+c)}`; // ex: 1A
      const el = document.createElement('button');
      el.type="button";
      el.className = 'seat' + (r<=CONFIG.PREMIUM_ROWS ? ' premium' : '');
      el.textContent = id;
      el.setAttribute('aria-label', 'Si√®ge '+id + (r<=CONFIG.PREMIUM_ROWS?' (premium)':''));
      // probabilit√© de si√®ge occup√© pour montrer l'effet
      if(Math.random()<0.12){ el.classList.add('busy'); el.title="Occup√©"; }
      el.onclick = ()=>{
        [...container.querySelectorAll('.seat.sel')].forEach(s=>s.classList.remove('sel'));
        el.classList.add('sel');
        document.getElementById('seatChosen').textContent = id + (el.classList.contains('premium')?' (premium)':'');
        updatePricePreview();
      };
      container.appendChild(el);
    }
  }
}
function selectedSeatIsPremium(){
  const s = document.querySelector('.seat.sel');
  return s && s.classList.contains('premium');
}

/* ================== R√âSERVATION ================== */
const tripsToday = {count:0}; // compteur simple pour KPIs

function simulateSearch(){
  const from = document.getElementById('from').value;
  const toSel = document.getElementById('to');
  const to = toSel.value;
  const dateStr = document.getElementById('date').value;
  const usePass = document.getElementById('usePass').checked;

  if(!from || !to || !dateStr){alert('Remplis ville, station et date.');return}
  const d = new Date(dateStr+"T12:00:00");

  if(!inSeason(d)){
    alert("Date hors saison (configurable).");
    return;
  }
  if(CONFIG.WEEKEND_ONLY && !isWeekend(d)){
    alert("Les navettes roulent ven/sam/dim uniquement.");
    return;
  }

  // Heures type (ou r√©cup√©r√©es d‚Äôun backend)
  const dep = "07:00", ret = "16:45";
  document.getElementById('r-route').textContent = `${from} ‚áÑ ${to}`;
  document.getElementById('r-times').textContent = `D√©part ${dep} ‚Äî Retour ${ret}`;

  // Charge attendue simple (exemple) : plus on se rapproche + plus c‚Äôest plein
  const leadDays = Math.max(0, Math.round((d - new Date())/86400000));
  const expectedLoad = clamp(0.25 + 0.6*(1 - Math.min(leadDays,30)/30) + (Math.random()*0.1-0.05), 0, 0.98);

  // Prix
  let price = dynamicPrice(leadDays, expectedLoad);
  if(usePass) price = 0; // usage d'un cr√©dit de forfait

  // M√©moriser pour recalcul avec si√®ge premium
  window.__priceBase = price;
  updatePricePreview();

  // Construire plan de si√®ges
  buildSeatmap(document.getElementById('seatmap'));

  // M√©t√©o rapide pour la station choisie
  const lat = toSel.selectedOptions[0].dataset.lat;
  const lon = toSel.selectedOptions[0].dataset.lon;
  loadOneWeatherCard(to, lat, lon);

  document.getElementById('result').classList.add('show');
  document.getElementById('result').scrollIntoView({behavior:'smooth'});
}

function updatePricePreview(){
  const base = window.__priceBase ?? 0;
  const add = selectedSeatIsPremium() ? CONFIG.PREMIUM_FEE : 0;
  document.getElementById('r-price').textContent = `CHF ${(base+add).toFixed(0)}.‚Äì`;
}

function checkout(){
  const seat = document.querySelector('.seat.sel');
  if(!seat){alert("Choisis un si√®ge.");return}
  tripsToday.count++;
  updateKPIs();
  alert("Flux de paiement (prototype). Sur prod : Stripe/PSP + r√©capitulatif.");
}

/* ================== KPI IMPACT (objectif 3) ================== */
function updateKPIs(){
  const trips = tripsToday.count;
  document.getElementById('kpiTrips').textContent = trips;

  // Conversion tr√®s simple : 1 trajet = 1 voiture √©vit√©e (ajuste si besoin)
  const cars = trips;
  document.getElementById('kpiCars').textContent = cars;

  // CO‚ÇÇ √©vit√© ‚âà (voiture ‚Äì bus/pax) √ó km
  const co2car = CONFIG.AVG_ROUNDTRIP_KM * CONFIG.CO2_CAR_KG_PER_KM;
  const co2bus = CONFIG.AVG_ROUNDTRIP_KM * CONFIG.CO2_BUS_KG_PER_KM_PER_PAX;
  const saved = Math.max(0,(co2car - co2bus)) * trips;
  document.getElementById('kpiCO2').textContent = Math.round(saved) + " kg";
}

/* ================== M√âT√âO (exemple Open-Meteo) ================== */
const STATIONS = [
  {name:"Verbier", lat:46.096, lon:7.228},
  {name:"Crans-Montana", lat:46.311, lon:7.480},
  {name:"Zermatt", lat:46.020, lon:7.749},
];
function renderWeatherCard(name, t, snow){ // tr√®s compact
  return `<div class="step"><b>${name}</b><div style="font-size:28px">${t}¬∞C</div><div>${snow} cm neige (24h)</div></div>`;
}
async function loadWeather(){
  const wrap = document.getElementById('weatherRow');
  wrap.innerHTML = "";
  for(const s of STATIONS){ await loadOneWeatherCard(s.name, s.lat, s.lon, false); }
}
async function loadOneWeatherCard(name, lat, lon, replace=true){
  try{
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m,snowfall&daily=snowfall_sum&forecast_days=1&timezone=auto`;
    const r = await fetch(url); const j = await r.json();
    const t = Math.round((j.hourly?.temperature_2m?.[0] ?? 0));
    const snow = Math.round((j.daily?.snowfall_sum?.[0] ?? 0));
    const card = renderWeatherCard(name, t, snow);
    const wrap = document.getElementById('weatherRow');
    wrap.innerHTML = replace ? card : (wrap.innerHTML + card);
  }catch(e){
    // Fallback silencieux
  }
}

/* Init */
loadWeather();
updateKPIs();

// Pr√©-remplir date sur prochain week-end de saison
(function setDefaultDate(){
  const input = document.getElementById('date');
  const today = new Date();
  let d = new Date(today);
  // avancer jusqu‚Äô√† ven/sam/dim dans la saison
  for(let i=0;i<14;i++){
    d = new Date(d.getTime()+86400000);
    if(inSeason(d) && isWeekend(d)) break;
  }
  input.value = d.toISOString().split('T')[0];
})();
</script>
</body>
</html>
